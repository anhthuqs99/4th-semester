Всем привет
Тут пишем конспект лекции. 


Универсальный алгоритм отсечения
Вейлера-Азертона
(отсечение произвольных многоугольников произвольными отсекателями)

Многоугольники могут быть невыпуклыми и могут содержать отверстия.

Алгоритм позволяет находить как внешние, так и внутренние многоугольники (есть аналогичный алгоритм в трехмерной графике)

Работа алгоритма сводится к работе с двунаправленными кольцевыми списками.

Границы отсеченных многоугольников совпадают либо с границами исходного мн-ка либо либо с границами отсекателя. В результате отсечения новые границы не появляются

Внешние границы многоугольников должны обходиться по часовой стрелке, внутренние - против. ( главное - в разных направлениях)

Необходимо найти точки пересечения ребер отсекаемого с ребрами отсекателя. Удобно использовать параметрическую форму описания.

На этапе ввода исходных данных для каждой границы многоугольника необходимо  создать список, занеся в него информацию о каждой вершине многоугольника. После нахождения точек пересечения необходимо добавить в ранее созданные списки элементов с информацией о точках пересечения (на соответствующие места, в два списка - границ отсекаемого многоугольника и отсекателя)

Целесообразно установить двунаправленные связи между элементами списков, хранящих информацию о точках пересечения.

Найденные точки пересечения следут разбить на две группы: точки входа и точки выхода.

Точка входа - в этой точке ребро отсекаемого многоугольника входит внутрь отсекателя.

Точка выхода - ребро отсекаемого многоугольника выходит из отсекателя наружу.

Рис. 1 
Отсекатель красным, отсекаемое синим

Точки входа I1, I3, I5, I8
Точки выхода I2, I4, I6, I7
Формируем списки и начинаем работу:
    
A1, A2, I1, A3, I2, A4, I3, A5, I4, I5, I6, A1
A6. I7, A7, I8, A8, A6

C1, I6, I1, C2, I2, I8, C3, I7, I3, C4, C5, C1
C6, I4, C7, C8, I5, C6 
(считайте эти списки кольцевыми)

Для нахождения внутреннего многоугольника просмотр элементов списка надо начать с точки входа и просматривать элементы списка границ отсекаемого многоугольника в направлении от начала списка к его концу. Просмотренные вершины копируются в список вершин мнгоугольника и просматриваются элементы списка до встречи точки пересечения. Если она встречена - переходим к границами другого многоугольника. Внутренняя часть всегда расположена справа, реализуем поворот вправо.

Если двусторонней связи не установлено - перебором искать нужную точку пересечения.

Результирующий список:
I1, A3, I2, I8, A8, A6, I7, I3, A5, I4, C7, C8, I5, I6, I1

Завершаем просмотр

 Для поиска новых многоугольников надо начать с новой точки входа, но если она попала в ранее найденные многоугольники, то...? (пропустить)(новых мн-ков не образуется, вероятно)

Рис. 2
Полученный многоугольник

Для нахождения внешних многоугольников просмотр вершин надо начинать с точки выхода. Отличие в том, что список границ отсекателя надо просматривать от конца к началу (в обратном направлении).

Внешние многоугольники, по рис 1.
C5
I2, A4, I3, I7, A7, I8, I2

I4, I5, C8, C7, I4 
I6, A1, A2, I1, I6

Рис. 3
Как отделять точки входа и точки выхода друг от друга? Никак

Векторное произведение
A1 * C1C2 > 0
I1 - это точка входа

Векторное произведение
A1A2 * C2C3 < 0
I2 - это точка выхода

Рис. 4
Частный случай. Расположение вершины многоугольник на ребре отсекателя

Проблема возникает, если вершина многоугольника расположена на границе отсекаткля. Надо отделять точки касания от точек пересечения.
I1 - точка касания
I2 - точка пересечения
Проверить, принадлежит ли точка за ребром-вектором отсекаемому многоугольнику

Рис. 5
Частный случай. Отсекаемый многоугольник касается границы отсекателя вершиной

Задание к экзамену. Что является причиной этому? Как это разрешить? "Решение связано с договоренностью, которую мы ввели в самом начале"

Рис. 6
Частный случай. Границы отсекателя и отсекаемого не пересекаются. Отсекатель красным.

Проводим тест лучом. 

Границы отсекателя попавшего внутрь отсекаемого проделывают в нем дыры. Внутриенние границы обходим по часовой стрелке. Внешние - против часовой.

>:]
спасибо тебе или вам за труды
